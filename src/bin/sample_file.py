
import os
import random

def sample_files(directory, probability):
    """
    Randomly samples files from a directory based on a given probability.
    Returns a list of sampled file paths.
    """
    all_files = [os.path.join(directory, file) for file in os.listdir(directory) if os.path.isfile(os.path.join(directory, file))]
    print("all_files: ", len(all_files))
    return [file for file in all_files if random.random() < probability]

# Define the directories and their respective sampling probabilities
directory1 = '/dir1'
probability1 = 0.3*0.97  # 50% probability for directory 1

directory2 = '/dir2'
probability2 = 0.3*0.03  # 30% probability for directory 2

# Sample files from each directory
sampled_files_dir1 = sample_files(directory1, probability1)
sampled_files_dir2 = sample_files(directory2, probability2)

# Combine the lists if needed
combined_sampled_files = sampled_files_dir1 + sampled_files_dir2

# Print or process the sampled files
print("Sampled files from directory 1:", len(sampled_files_dir1))
print("Sampled files from directory 2:", len(sampled_files_dir2))
print("Combined sampled files:", len(combined_sampled_files),)

# copy files to new directory
import shutil
for file in sampled_files_dir1:
    shutil.copy(file, '/dst_dir1')
for file in sampled_files_dir2:
    shutil.copy(file, '/dst_dir2')
